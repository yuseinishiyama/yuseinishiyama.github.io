<!doctype html>
<html lang="jp">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>だからといって、このままでいいはずがない。 - Programmingだからといって、このままでいいはずがない。</title>

    <link rel="stylesheet" href="http://yuseinishiyama.com/theme/css/main.css">
    <link rel="stylesheet" href="http://yuseinishiyama.com/theme/css/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <div><img src="" class="grv-img"/></div>
        <div class="title"><a href="http://yuseinishiyama.com/">だからといって、このままでいいはずがない。 </a></div>
        <div class="sub-title"></div>

<p>
    <div class="view"><a href="http://yuseinishiyama.com/pages/about-me.html">About Me</a></div>
  <div class="view"><a href="http://yuseinishiyama.com/archives.html">Archives</a></div>
  <div class="view"><a href="http://yuseinishiyama.com/categories">Categories</a></div>
</p>

<!-- Social links -->
<div class="social">
<h4>Follow Me</h4>
<ul>
    <li><a href="https://twitter.com/yuseinishiyama">twitter</a></li>
    <li><a href="https://github.com/yuseinishiyama">github</a></li>
</ul>
</div>

      </header>
      <section>
      <div class="front-title"><a href="http://yuseinishiyama.com/posts/2014/05/26/build-your-own-lisp/">"Build Your Own Lisp"をやってみて</a></div>
<p>
<small>
<abbr class="published" title="2014-05-26T01:30:00">
  2014-05-26(月)
</abbr> | 
 -- (<a href="http://yuseinishiyama.com/posts/2014/05/26/build-your-own-lisp/" rel="bookmark">permalink</a>)
</small>
</p>      <h1>はじめに</h1>
<p>私は、業務で主にObjective-Cを利用しているのだが、Cがよく分からないままObjective-Cを使っていると、なんともいえないモヤモヤした気持ちになる。低レイヤのAPIを使用するときや <s>、老害っぽいコード読む時など、</s>Cがよく分かっていないことを痛感させられる。Cをほとんど学んだことがないままで、CのスーパーセットであるObjective-Cをやっている。こうした境遇の人は結構多そうだ。そこで、Cを勉強するのに良いテーマが無いかと探していたところ下記のサイトを発見した。</p>
<p><a href="http://www.buildyourownlisp.com/">Buil Your Own Lisp</a></p>
<p>うん、これしかないだろう。何かの言語を学ぶときにLispの処理系を作るのは定番だ。CでLispを実装し、HaskellでLispを実装し、LispでLispを実装するのだ(超言語抽象)。というわけで、このチュートリアルを最後までやってみたのだが、日本語の記事でこの内容に言及しているものはほとんどなかったので、どんな内容であったのか簡単にまとめてみた。一部翻訳があるが、完全に意訳である。ご了承いただきたい。</p>
<h1>どんな人がやるべきか</h1>
<p>これは著者が冒頭で述べている通りである。</p>
<blockquote>
<p>This book is for anyone wanting to learn C, or who has once wondered how to build ...</p></blockquote> 
      <div class="read-more"><a href="http://yuseinishiyama.com/posts/2014/05/26/build-your-own-lisp/">read more...</a></div>
      <hr />
      <div class="front-title"><a href="http://yuseinishiyama.com/posts/2014/02/19/open-hack-day-japan2/">Open Hack Day Japan 2に参加してきた。</a></div>
<p>
<small>
<abbr class="published" title="2014-02-19T00:49:00">
  2014-02-19(水)
</abbr> | 
 -- (<a href="http://yuseinishiyama.com/posts/2014/02/19/open-hack-day-japan2/" rel="bookmark">permalink</a>)
</small>
</p>      <h1>はじめに</h1>
<p>2/15-16と2日間に渡って行われた、Open Hack Day Japan 2というイベントに参加してきた。
ここではイベントの概要、開発したプロダクト、参加して得た感想について述べる。</p>
<h1>Open Hack Day Japan 2とは</h1>
<blockquote>
<p>Hack Dayは世界各国のYahoo!で開催されている開発イベントで、24時間という限られた時間で自由にアイデアを創造、実際に開発し、できあがったプロトタイプを発表します。日常の業務から離れ、自由な発想で、好きな技術を使って開発に取り組めるクリエイティブマインドにあふれたHack Dayは、ヤフー社内で300人近くの参加者を集める人気イベントです。</p>
</blockquote>
<p>これをヤフーが社外にも公開したのがOpen Hack Dayであり、今回はその2回目となる。
今回も参加者約350名、チーム数80強と、比較的大規模なイベントとなったようだ。</p>
<blockquote class="twitter-tweet" lang="ja"><p>3, 2, 1, Hack Time!!!!&#10;Open Hack Day 2 はじまりましたー！&#10; <a href="http://t.co/0gtMRrzk8h">http://t.co/0gtMRrzk8h</a> <a href="https://twitter.com/search?q=%23openhackday&amp;src=hash">#openhackday</a> <a href="http://t.co/MDabbnR5DU">pic ...</a></p></blockquote> 
      <div class="read-more"><a href="http://yuseinishiyama.com/posts/2014/02/19/open-hack-day-japan2/">read more...</a></div>
      <hr />
      <div class="front-title"><a href="http://yuseinishiyama.com/posts/2014/02/12/rejection-for-advertisingIdentifier/">advertisingIdentifierが原因のリジェクトに対応する。</a></div>
<p>
<small>
<abbr class="published" title="2014-02-12T00:11:00">
  2014-02-12(水)
</abbr> | 
 -- (<a href="http://yuseinishiyama.com/posts/2014/02/12/rejection-for-advertisingIdentifier/" rel="bookmark">permalink</a>)
</small>
</p>      <h1>概要</h1>
<p>この2月からadvertisingIdentifierの利用方法が原因でリジェクトされるケースが大量に発生しているようだ。自分自身でadvertisingIDを利用するコードを書いている人はあまりいないであろうが、UDIDが利用できなくなった現在、効果測定を行うSDKの大半がトラッキングのためにこのIDを利用している。そして、このadvertisingIDの利用方法がリジェクトされてしまう原因であるようだ。</p>
<p>ちなみにリジェクトされるとこのようなメッセージがくる。</p>
<blockquote>
<p>PLA 3.3.12</p>
<p>We found your app uses the iOS Advertising Identifier but does not include ad functionality. This does not comply with the terms of the iOS Developer Program License Agreement, as required by the App Store Review Guidelines.</p>
<p>Specifically ...</p></blockquote> 
      <div class="read-more"><a href="http://yuseinishiyama.com/posts/2014/02/12/rejection-for-advertisingIdentifier/">read more...</a></div>
      <hr />
      <div class="front-title"><a href="http://yuseinishiyama.com/posts/2014/01/31/transition-from-wordpress-to-pelican/">WordpressからPelicanに移行中</a></div>
<p>
<small>
<abbr class="published" title="2014-01-31T00:00:00">
  2014-01-31(金)
</abbr> | 
 -- (<a href="http://yuseinishiyama.com/posts/2014/01/31/transition-from-wordpress-to-pelican/" rel="bookmark">permalink</a>)
</small>
</p>      <p>静的サイトジェネレーターを使いたかったので、Wordpressをやめた。
現在、Pelicanに移行中。</p> 
      <div class="read-more"><a href="http://yuseinishiyama.com/posts/2014/01/31/transition-from-wordpress-to-pelican/">read more...</a></div>
      <hr />
      <div class="front-title"><a href="http://yuseinishiyama.com/posts/2013/12/24/face-detection-from-movie/">動画に対する顔検出</a></div>
<p>
<small>
<abbr class="published" title="2013-12-24T22:32:00">
  2013-12-24(火)
</abbr> | 
 -- (<a href="http://yuseinishiyama.com/posts/2013/12/24/face-detection-from-movie/" rel="bookmark">permalink</a>)
</small>
</p>      <p>(この投稿はQiitaの<a href="http://qiita.com/advent-calendar/2013/ios-2">iOS Second Stage Advent Calendar
2013</a>の25日目の記事です)</p>
<p>もはや非常に一般的となった、CIDetectorによる顔検出。  </p>
<p>ただ、よく見るサンプルはほとんどカメラの入力に対するリアルタイム検出ばかりだったので、</p>
<p>試しに動画に対して顔を検出するサンプルを作成してみた。</p>
<p><a href="https://github.com/yuseinishiyama/VideoFaceDetection">https://github.com/yuseinishiyama/VideoFaceDetection</a></p>
<p>CIDetectorとAVAssetReaderを組み合わせるだけで簡単にできる。</p>
<p>VFDVideoFaceDetector.h</p>
<div class="highlight"><pre><span class="cp">#import &lt;Foundation/Foundation.h&gt;</span>

<span class="k">typedef</span> <span class="nf">void</span><span class="p">(</span><span class="o">^</span><span class="n">VFDVideoReaderCompletionHandler</span><span class="p">)(</span><span class="n">NSArray</span> <span class="o">*</span><span class="n">allFeatures</span><span class="p">);</span>

<span class="k">@interface</span> <span class="nc">VFDVideoFaceDetector</span> : <span class="nc">NSObject</span>
<span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">readFromURL:</span><span class="p">(</span><span class="n">NSURL</span> <span class="o">*</span><span class="p">)</span><span class="nv">targetURL</span>
<span class="nl">complitionHandler:</span><span class="p">(</span><span class="n">VFDVideoReaderCompletionHandler</span><span class="p">)</span><span class="nv">completionHandler</span><span class="p">;</span>
<span class="k">@end</span>
</pre></div>


<p>VFDVideoFaceDetector.m</p>
<div class="highlight"><pre><span class="cp">#import &quot;VFDVideoFaceDetector.h&quot;</span>
<span class="cp">#import &lt;AVFoundation/AVFoundation.h ...</span></pre></div> 
      <div class="read-more"><a href="http://yuseinishiyama.com/posts/2013/12/24/face-detection-from-movie/">read more...</a></div>
      <hr />
      <div class="front-title"><a href="http://yuseinishiyama.com/posts/2013/11/13/tech-hills7/">第7回テックヒルズにいってきました。</a></div>
<p>
<small>
<abbr class="published" title="2013-11-13T02:27:00">
  2013-11-13(水)
</abbr> | 
 -- (<a href="http://yuseinishiyama.com/posts/2013/11/13/tech-hills7/" rel="bookmark">permalink</a>)
</small>
</p>      <p>Unityを触ったり、簡単なシェーダー書いたりしてるうちに描画処理への関心が高まってきた。ゲームとかグラフィックスの分野は、一定以上のものを作るために比較的コアな知識がいる一方で、結果がキャッチーで分かりやすい。ゲームにはあまり興味がない私だが、ゲームエンジンブームである。先日、<a href="http://d.hatena.ne.jp/hdk_embedded/20131106/1383681073">「Playgroundハッカソン」</a>に参加してからというもの、ますます興味が湧いてきている。</p>
<p>そんなわけで、「Game
Engines」がテーマの<a href="http://atnd.org/events/44622" title="第7回テックヒルズ">第7回テックヒルズ</a>に行ってきた。</p>
<p>以下が公開されているスライドへのリンクだ(一部、公開が確認できていないものもある)。</p>
<ol>
<li><a href="http://www.slideshare.net/keigoando/unity2-dnew-gui" title="Unity2DとnewGUIについて">「Unity2DとnewGUIについて」</a>安藤
    圭吾さん(ユニティ・テクノロジーズ・ジャパン)</li>
<li><a href="http://www.slideshare.net/KatsutoshiMakino/aiming" title="Aiming開発ゲームの裏側">「Aiming開発ゲームの裏側」</a>牧野 克俊さん(Aiming)</li>
<li><a href="http://www.slideshare.net/doraemonsss/cocos2d-x-28145813?ref=http://sssslide.com/www.slideshare.net/doraemonsss/cocos2d-x-28145813" title="cocos2d-xおよび開発ツールについて">「cocos2d-xおよび開発ツールについて」</a>清水 友晶さん(TKS2)</li>
<li>「 enchant.jsの野望 9分コーディングライブ」 清水
    亮さん(ユビキタスエンターテインメント)</li>
<li><a href="http://www.slideshare.net/KeiNakazawa/131112-tech-hills-playground-introduction" title="Introduction">「イントロダクション」</a>
    &amp;<a href="http://www.slideshare.net/RomainPiquois/playground-28101668" title="Playground内の描画仕組み">「Playgroundの描画仕組み」</a>＆<a href="http://www.slideshare.net/KeiNakazawa/playgroundandroid-pfandroid" title="&quot;Playground&quot;とAndroid">「マルチPF対応ゲームエンジン内のAndroid対応」</a>ロマン・ピコアさん(KLab)
    ・中澤 慧さん(KLab)</li>
<li>「次世代ゲームエンジンの比較 ...</li></ol> 
      <div class="read-more"><a href="http://yuseinishiyama.com/posts/2013/11/13/tech-hills7/">read more...</a></div>
      <hr />
      <div class="front-title"><a href="http://yuseinishiyama.com/posts/2013/10/09/change-theme/">テーマを変更しました。</a></div>
<p>
<small>
<abbr class="published" title="2013-10-09T00:00:00">
  2013-10-09(水)
</abbr> | 
 -- (<a href="http://yuseinishiyama.com/posts/2013/10/09/change-theme/" rel="bookmark">permalink</a>)
</small>
</p>      <p>開発者のWordpressサイトがデフォルトのテーマだというのもなんとなく恥ずかしいので、テーマを作成してみた。とはいえ、Webの開発経験は全然ないので結構苦戦した。未だにあちこち粗が目立つ。しかし、「そのうち全部直して適応〜」とかいってると、一生デフォルトのを使い続けそうなので、先に本番環境に適応してから少しずつ修正することにした。</p>
<p>レスポンシブデザインとかそういうことも考えだすと、自作するのを辞めたい衝動に駆られてしまうが・・・。</p> 
      <div class="read-more"><a href="http://yuseinishiyama.com/posts/2013/10/09/change-theme/">read more...</a></div>
      <hr />
      <div class="front-title"><a href="http://yuseinishiyama.com/posts/2013/09/16/get-latest-app-version-of-ios-application/">iOSでアプリの最新バージョンを取得する方法。</a></div>
<p>
<small>
<abbr class="published" title="2013-09-16T21:50:00">
  2013-09-16(月)
</abbr> | 
 -- (<a href="http://yuseinishiyama.com/posts/2013/09/16/get-latest-app-version-of-ios-application/" rel="bookmark">permalink</a>)
</small>
</p>      <p>開発者であれば、ユーザーには自分の開発したアプリの最新版を使ってほしいと思うだろう。また、ユーザーのアプリバージョンにばらつきがないことは、ビジネス面のメリットも大きい。仕事として開発を行っている人であれば、「アプリのアップデートが行われた場合に通知する機能」の実装を要求されたことは多々あるだろう。</p>
<p>そこで今回は、</p>
<p>アプリの最新版を取得し、ユーザーが利用しているアプリが最新版より古ければ通知する機能</p>
<p>の実装方法を紹介する。</p>
<p>さて、まず考えなくてはいけないのは、どこからアプリの最新版を取得するか、ということである。これにはおおまかに言って、2通りの方法がある。「1.自前のサーバを利用する方法」、と「2.AppleのAPIを利用する方法」の2つだ。どちらが適切な方法であるか比較するために、それぞれのメリット、デメリットを挙げてみた。</p>
<p>1.自前のサーバを利用する方法</p>
<p>メリット</p>
<ul>
<li>テストが容易。</li>
<li>更新のタイミングを自由に決めることができる。</li>
<li>取得先が勝手に変更されることがない。</li>
</ul>
<p>デメリット</p>
<ul>
<li>運用者が必要。</li>
<li>運用ミスが発生する可能性がある。</li>
</ul>
<p>2.AppleのAPIを利用する方法。</p>
<p>メリット</p>
<ul>
<li>自分で運用しなくて良い。</li>
<li>運用ミスが発生しない。</li>
</ul>
<p>デメリット</p>
<ul>
<li>テストが行えない。</li>
<li>APIが変更された場合、機能が無効になる。</li>
<li>APIから取得できるバージョンと、ストアへ反映されているバージョンとの間にタイムラグがあったりなどした場合、その間はどうすることもできない。</li>
</ul>
<p>結論から言うと、「AppleのAPIを使ったほうが楽だが ...</p> 
      <div class="read-more"><a href="http://yuseinishiyama.com/posts/2013/09/16/get-latest-app-version-of-ios-application/">read more...</a></div>
      <hr />
      <div class="front-title"><a href="http://yuseinishiyama.com/posts/2013/09/07/addition-to-required-device-capability/">UnityでiOS向けのビルド時に、RequiredDeviceCapabilityを追加する方法。</a></div>
<p>
<small>
<abbr class="published" title="2013-09-07T21:06:00">
  2013-09-07(土)
</abbr> | 
 -- (<a href="http://yuseinishiyama.com/posts/2013/09/07/addition-to-required-device-capability/" rel="bookmark">permalink</a>)
</small>
</p>      <p><a href="https://developer.apple.com/library/ios/documentation/general/Reference/InfoPlistKeyReference/Articles/iPhoneOSKeys.html">RequiredDeviceCapability</a>を正しく設定していないと、Appleにリジェクトされてしまうことは、広く知られている。</p>
<p>例えば、アプリに静止画を撮影する機能がある場合、このRequiredDeviceCapabilityに「still-camera」を追加してやらないといけない。</p>
<p>RequiredDeviceCapabilityは正しく設定されていなくても、ビルドに失敗しないし、Validationも通過する。だからこそ、リジェクトされてから気づくわけで、こういう作業は特に自動化するメリットが大きいだろう。</p>
<p>そこで、PostProcessBuildPlayerを利用し、Unityからのビルド時にInfo.plistを書き換えて、RequiredDeviceCapabilityを編集する関数を作成してみた。</p>
<div class="highlight"><pre><span class="k">def</span> <span class="nf">process_plist</span><span class="p">(</span><span class="n">plist_filepath</span><span class="p">):</span>
  <span class="n">pl</span> <span class="o">=</span> <span class="n">plistlib</span><span class="o">.</span><span class="n">readPlist</span><span class="p">(</span><span class="n">plist_filepath</span><span class="p">)</span>
  <span class="n">new_settings</span> <span class="o">=</span> <span class="p">{</span><span class="s">&quot;still-camera&quot;</span><span class="p">}</span>
  <span class="k">if</span> <span class="s">&quot;UIRequiredDeviceCapabilities&quot;</span> <span class="ow">in</span> <span class="n">pl</span><span class="p">:</span>
    <span class="n">pl</span><span class="p">[</span><span class="s">&quot;UIRequiredDeviceCapabilities&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">new_settings</span><span class="p">)</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">pl</span><span class="p">[</span><span class="s">&quot;UIRequiredDeviceCapabilities&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">new_settings</span><span class="p">]</span>
  <span class="n">plistlib</span><span class="o">.</span><span class="n">writePlist</span><span class="p">(</span><span class="n">pl</span><span class="p">,</span> <span class="n">plist_filepath</span><span class="p">)</span>
</pre></div>


<p>Info.plistのパスを与えてやると、Info.plistに「still-camera ...</p> 
      <div class="read-more"><a href="http://yuseinishiyama.com/posts/2013/09/07/addition-to-required-device-capability/">read more...</a></div>
      <hr />
      <div class="front-title"><a href="http://yuseinishiyama.com/posts/2013/09/06/screenshot-with-unity-ios/">Unityでスクリーンショットを撮影し、iPhoneのカメラロールに保存する方法。</a></div>
<p>
<small>
<abbr class="published" title="2013-09-06T02:55:00">
  2013-09-06(金)
</abbr> | 
 -- (<a href="http://yuseinishiyama.com/posts/2013/09/06/screenshot-with-unity-ios/" rel="bookmark">permalink</a>)
</small>
</p>      <p>Unityでスクリーンショットを撮るのは非常に簡単である。</p>
<p><a href="http://docs.unity3d.com/Documentation/ScriptReference/Application.CaptureScreenshot.html">Application.CaptureScreenshot</a>という関数が用意されているからだ。</p>
<p>だが、この方法ではアプリのデータ領域に画像が保存されるだけなので、ユーザーが、その画像を閲覧できるようにはならない。アプリ内で画像を管理できるようにしてもいいかもしれないが、スクリーンショットを確認したいだけなのであれば、そこまでする必要はないだろう。</p>
<p>そこで今回は、UnityからiOSのカメラロールにアクセスする方法を紹介する。</p>
<div class="highlight"><pre><span class="cp">#import &lt;Foundation/Foundation.h&gt;</span>
<span class="cp">#import &lt;AssetsLibrary/AssetsLibrary.h&gt;</span>
<span class="cp">#import &lt;AVFoundation/AVFoundation.h&gt;</span>

<span class="cm">/* </span>
<span class="cm"> スクリーンショット撮影時に利用するネイティブコード。</span>
<span class="cm"> */</span>

<span class="c1">// 指定したパスの画像をカメラロールに保存する。</span>
<span class="k">extern</span> <span class="s">&quot;C&quot;</span> <span class="kt">void</span> <span class="n">_WriteImageToAlbum</span> <span class="p">(</span><span class="k">const</span> <span class="kt">char</span><span class="o">*</span> <span class="n">path</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">UIImage</span> <span class="o">*</span><span class="n">image</span> <span class="o">=</span> <span class="p">[</span><span class="n">UIImage</span> <span class="n">imageWithContentsOfFile</span><span class="o">:</span><span class="p">[</span><span class="n">NSString</span> <span class="n">stringWithUTF8String</span><span class="o">:</span><span class="n">path</span><span class="p">]];</span>
    <span class="n">ALAssetsLibrary</span> <span class="o">*</span><span class="n">library</span> <span class="o">=</span> <span class="p">[[[</span><span class="n">ALAssetsLibrary</span> <span class="n">alloc</span><span class="p">]</span> <span class="n">init</span><span class="p">]</span> <span class="n">autorelease</span><span class="p">];</span>
    <span class="n">NSMutableDictionary</span> <span class="o">*</span><span class="n">metadata</span> <span class="o">=</span> <span class="p">[[[</span><span class="n">NSMutableDictionary ...</span></pre></div> 
      <div class="read-more"><a href="http://yuseinishiyama.com/posts/2013/09/06/screenshot-with-unity-ios/">read more...</a></div>
      <hr />

<span class="paginator">

  Page 1 / 2
    <a href="http://yuseinishiyama.com/category/programming2.html">&raquo;</a>
</span>
      </section>
      <footer>
        <p><small>&copy; だからといって、このままでいいはずがない。 &mdash; Theme based on Sundown by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <!-- Scale fix -->
    <script>
      var metas = document.getElementsByTagName('meta');
      var i;
      
      if (navigator.userAgent.match(/iPhone/i)) {
        for (i=0; i<metas.length; i++) {
          if (metas[i].name == "viewport") {
            metas[i].content = "width=device-width, minimum-scale=1.0, maximum-scale=1.0";
          }
        }
      
        document.addEventListener("gesturestart", gestureStart, false);
      }

      function gestureStart() {
        for (i=0; i<metas.length; i++) {
          if (metas[i].name == "viewport") {
            metas[i].content = "width=device-width, minimum-scale=0.25, maximum-scale=1.6";
          }
        }
      }
    </script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-48020408-1', 'yuseinishiyama.com');
  ga('send', 'pageview');
</script>
  </body>
</html>