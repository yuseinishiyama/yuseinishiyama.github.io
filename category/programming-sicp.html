<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<!--
Design by Free CSS Templates
http://www.freecsstemplates.org
Released for free under a Creative Commons Attribution 2.5 License

Name       : Brown Stone  
Description: A two-column, fixed-width design with dark color scheme.
Version    : 1.0
Released   : 20100928

-->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta name="keywords" content="" />
<meta name="description" content="" />
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<title>だからといって、このままでいいはずがない。 - Programming, SICP</title>
<link href="/theme/css/style.css" rel="stylesheet" type="text/css" media="screen" />
<link href="/" type="application/atom+xml" rel="alternate" title="だからといって、このままでいいはずがない。 ATOM Feed" />
</head>
<body>
<div id="wrapper">
	<div id="page">
		<div id="page-bgtop">
			<div id="page-bgbtm">
 
        
				<div id="content">
					<div class="post">
						<h2 class="title"><a href="/sicp-3-1-2-the-benefits-of-introducing-assignment.html">SICP 3.1.2 The Benefits of Introducing Assignment</a></h2>
						<p class="meta"><span class="date">Le  </span><span class="posted">Par <a href="#">nishiyama101</a></span><span>&nbsp; | Catégorie : <a href="/category/programming-sicp.html">Programming, SICP</a></span></p>
					<p class="meta">Tags : </p>
						<div style="clear: both;">&nbsp;</div>
						<div class="entry">
						 <p>代入の効用について説明するだけにしては、Ex 3.5.
はちょっとやり過ぎな気もするが、なかなか興味深い内容ではある。</p>
<blockquote>
<p>Monte Carlo integration is a method of estimating definite integrals
by means of Monte Carlo simulation. Consider computing the area of a
region of space described by a predicate P(x, y) that is true for
points (x, y) in the region and false for points not in the region.
For example, the region contained within a circle of radius 3 centered
at (5, 7) is described by the predicate that tests whether (x - 5)2 +
(y - 7)2\&lt; 32. To estimate the area of the region described by such a
predicate, begin by choosing a rectangle that contains the region. For
example, a rectangle with diagonally opposite corners at (2, 4) and
(8, 10) contains the circle above. The desired integral is the area of
that portion of the rectangle that lies in the region. We can estimate
the integral by picking, at random, points (x,y) that lie in the
rectangle, and testing P(x, y) for each point to determine whether the
point lies in the region. If we try this with many points, then the
fraction of points that fall in the region should give an estimate of
the proportion of the rectangle that lies in the region. Hence,
multiplying this fraction by the area of the entire rectangle should
produce an estimate of the integral.</p>
<p>Implement Monte Carlo integration as a procedure estimate-integral
that takes as arguments a predicate P, upper and lower bounds x1, x2,
y1, and y2 for the rectangle, and the number of trials to perform in
order to produce the estimate. Your procedure should use the same
monte-carlo procedure that was used above to estimate . Use your
estimate-integral to produce an estimate of by measuring the area of a
unit circle.</p>
<p>You will find it useful to have a procedure that returns a number
chosen at random from a given range. The following random-in-range
procedure implements this in terms of the random procedure used in
section 1.2.6, which returns a nonnegative number less than its
input.8</p>
<p>(define (random-in-range low high)<br />
 (let ((range (- high low)))<br />
 (+ low (random range))))</p>
</blockquote>
<p><a href="http://ja.wikipedia.org/wiki/%E3%83%A2%E3%83%B3%E3%83%86%E3%82%AB%E3%83%AB%E3%83%AD%E6%B3%95" title="モンテカルロ法">モンテカルロ法</a>を用いて、単位円の面積(円周率)を求める問題だ。</p>
<p>まず、乱数生成用の函数を定義する。<a href="http://sicp.g.hatena.ne.jp/hyuki/20060505/random" title="SRFI-27疑似乱数発生器インタフェース">乱数を扱うので、srfi-27を使用する</a>。</p>
<p>``` {.lang:lisp .decode:true title="Ex 3.5."}
;; ランダム数生成のため
(use srfi-27)</p>
<p>(define (random num)
  (* (random-real) num))</p>
<p>(define (random-in-range low high)
  (let ((range (- high low)))
    (+ low (random range))))</p>
<div class="highlight"><pre><span class="err">次に、テキスト内でも使用されているモンテカルロ函数。試行回数と試行内容から、試行の成功確率を出力する。</span>

<span class="err">```</span> <span class="p">{.</span><span class="n">lang</span><span class="o">:</span><span class="n">lisp</span> <span class="p">.</span><span class="n">decode</span><span class="o">:</span><span class="nb">true</span> <span class="n">title</span><span class="o">=</span><span class="s">&quot;Ex 3.5.&quot;</span><span class="p">}</span>
<span class="p">(</span><span class="n">define</span> <span class="p">(</span><span class="n">monte</span><span class="o">-</span><span class="n">carlo</span> <span class="n">trials</span> <span class="n">experiment</span><span class="p">)</span>
  <span class="p">(</span><span class="n">define</span> <span class="p">(</span><span class="n">iter</span> <span class="n">trials</span><span class="o">-</span><span class="n">remaining</span> <span class="n">trials</span><span class="o">-</span><span class="n">passed</span><span class="p">)</span>
    <span class="p">(</span><span class="n">cond</span> <span class="p">((</span><span class="o">=</span> <span class="n">trials</span><span class="o">-</span><span class="n">remaining</span> <span class="mi">0</span><span class="p">)</span>
        <span class="p">(</span><span class="o">/</span> <span class="n">trials</span><span class="o">-</span><span class="n">passed</span> <span class="n">trials</span><span class="p">))</span>
       <span class="p">((</span><span class="n">experiment</span><span class="p">)</span>
        <span class="p">(</span><span class="n">iter</span> <span class="p">(</span><span class="o">-</span> <span class="n">trials</span><span class="o">-</span><span class="n">remaining</span> <span class="mi">1</span><span class="p">)</span> <span class="p">(</span><span class="o">+</span> <span class="n">trials</span><span class="o">-</span><span class="n">passed</span> <span class="mi">1</span><span class="p">)))</span>
       <span class="p">(</span><span class="k">else</span>
        <span class="p">(</span><span class="n">iter</span> <span class="p">(</span><span class="o">-</span> <span class="n">trials</span><span class="o">-</span><span class="n">remaining</span> <span class="mi">1</span><span class="p">)</span> <span class="n">trials</span><span class="o">-</span><span class="n">passed</span><span class="p">))))</span>
  <span class="p">(</span><span class="n">iter</span> <span class="n">trials</span> <span class="mi">0</span><span class="p">))</span>
</pre></div>


<p>そして、数値積分を行う。矩形の面積に1.0をかけているのは、単に小数で結果を見たいからだ。</p>
<p>``` {.lang:lisp .decode:true title="Ex 3.5."}
(define (estimate-integral P x1 x2 y1 y2 trials)
  (define (rectangle-space)
    (<em> (- x2 x1)
       (- y2 y1)))
  (define (test)
    (P (random-in-range x1 x2) (random-in-range y1 y2)))
  (</em> (* (rectangle-space) 1.0)
     (monte-carlo trials test)))</p>
<div class="highlight"><pre><span class="err">最後に肝心の、正方形と</span><span class="p">(</span><span class="err">述語としての</span><span class="p">)</span><span class="err">円を与える。</span>

<span class="err">```</span> <span class="p">{.</span><span class="n">lang</span><span class="o">:</span><span class="n">lisp</span> <span class="p">.</span><span class="n">decode</span><span class="o">:</span><span class="nb">true</span> <span class="n">title</span><span class="o">=</span><span class="s">&quot;Ex 3.5.&quot;</span><span class="p">}</span>
<span class="p">(</span><span class="n">define</span> <span class="p">(</span><span class="n">estimate</span><span class="o">-</span><span class="n">pi</span> <span class="n">trials</span><span class="p">)</span>
  <span class="p">(</span><span class="n">define</span> <span class="p">(</span><span class="n">unit</span><span class="o">-</span><span class="n">circle</span><span class="p">)</span>
    <span class="p">(</span><span class="n">lambda</span> <span class="p">(</span><span class="n">x</span> <span class="n">y</span><span class="p">)</span> <span class="p">(</span><span class="o">&gt;=</span> <span class="mi">1</span> <span class="p">(</span><span class="o">+</span> <span class="p">(</span><span class="o">*</span> <span class="n">x</span> <span class="n">x</span><span class="p">)</span>
                  <span class="p">(</span><span class="o">*</span> <span class="n">y</span> <span class="n">y</span><span class="p">)))))</span>
  <span class="p">(</span><span class="n">estimate</span><span class="o">-</span><span class="n">integral</span> <span class="p">(</span><span class="n">unit</span><span class="o">-</span><span class="n">circle</span><span class="p">)</span>
               <span class="o">-</span><span class="mi">1</span> <span class="mi">1</span> <span class="o">-</span><span class="mi">1</span> <span class="mi">1</span>
               <span class="n">trials</span><span class="p">))</span>
</pre></div>


<p>大体100万回ぐらいで小数点以下2桁まで等しくなった。</p>
<p><code>{.lang:lisp .decode:true title="Ex 3.5."}
;; gosh&gt; (estimate-pi 10)
;; 3.6
;; gosh&gt; (estimate-pi 100)
;; 3.2
;; gosh&gt; (estimate-pi 1000)
;; 3.196
;; gosh&gt; (estimate-pi 10000)
;; 3.1216
;; gosh&gt; (estimate-pi 100000)
;; 3.13956
;; gosh&gt; (estimate-pi 1000000)
;; 3.142192
;; gosh&gt; (estimate-pi 1000000)
;; 3.143176</code></p>	
						</div>
					</div>
	
			                <div class="post">
			                        <h2 class="title">Autres articles</h2>
			                </div>
        
 
			                <div class="post summary">
						<h2 class="title"><a href="/sicp-%e7%ac%ac2%e7%ab%a0%e3%80%8cbuilding-abstractions-with-data%e3%80%8d%e3%80%90%e5%be%8c%e7%b7%a8%e3%80%91.html">SICP 第2章「Building Abstractions with Data」【後編】</a></h2>
						<p class="meta"><span class="date">Le 日 08 12月 2013</span><span class="posted">Par <a href="#">nishiyama101</a></span></p>
						<div style="clear: both;">&nbsp;</div>
						<div class="entry">
						 <p>後半はGeneric Procedure関する解説。</p>
<p>オブジェクト指向の言語で開発を行っていると、「そもそも型とは」というようなことを考える機会がほとんどない。言語のプリミティブな機能を利用して、型の仕組みを実装してみるのはなかなか貴重な経験だ。</p>
<p>ここでは、Generic Procedureを実現するための戦略が3つ紹介される。</p>
<ul>
<li>
<p>explicit dispatch  </p>
<p>総称関数側(「たす」、「ひく」など)が、データの型(「実数」、「複素数」など)を見て、実際に実行される函数を決定する。  </p>
<p>型が追加されるたびに、総称関数側の分岐を追加する必要がある。既存のコードを修正する必要があるので、余り得策とはいえない？</p>
</li>
<li>
<p>data-directed  </p>
<p>「総称函数名」、「型」、「実際に実行される函数」の結びつきを管理するテーブルを作成する。  </p>
<p>総称関数内での分岐を作る必要はないが、新しい函数や型が追加されるたびにグローバルなテーブルを更新する必要がある。</p>
</li>
<li>
<p>message-passing<br />
    "intelligent operation"ではなく、"intelligent data
    object"。つまり、型に応じた処理を行う「賢い処理」の代わりに、処理に応じて動作を変える「賢いデータ」を作るという方針。</p>
</li>
</ul>
<p>message-passingは非常にオブジェクト指向的だ。直交座標系で複素数を表現する ...</p>	
						 <a class="readmore" href="/sicp-%e7%ac%ac2%e7%ab%a0%e3%80%8cbuilding-abstractions-with-data%e3%80%8d%e3%80%90%e5%be%8c%e7%b7%a8%e3%80%91.html">Lire la suite …</a>
						</div>
					</div>
        
 
			                <div class="post summary">
						<h2 class="title"><a href="/emacs%e3%81%a7scheme%e3%81%ae%e8%87%aa%e5%8b%95%e8%a3%9c%e5%ae%8c%e3%82%92%e8%a1%8c%e3%81%86%e3%80%82.html">EmacsでSchemeの自動補完を行う。</a></h2>
						<p class="meta"><span class="date">Le 日 01 12月 2013</span><span class="posted">Par <a href="#">nishiyama101</a></span></p>
						<div style="clear: both;">&nbsp;</div>
						<div class="entry">
						 <p>環境構築に手間をかけたくない質なので、最初はDrRacketを利用してSchemeのコードを書いていた。</p>
<p><a href="http://www.atmarkit.co.jp/ait/articles/0812/17/news149_3.html" title="Gaucheでメタプログラミング">Gaucheでメタプログラミング</a></p>
<p>しかし、上記のサイトなどから、Emacsでも「別ウインドウで評価しながら、ソースを書けること」が分った。<br />
その結果、結局Emacs+Gaucheの環境に落ち着いた。</p>
<p>しばらくはこれで満足していたし、新しい言語であれば、全て手で打つことも、理解を早めるという点では無駄ではないだろう。  </p>
<p>しかし、SICPの分量・難易度を考えると、あまりゆっくりコーディングしている暇はない。さすがに、最低限の自動補完が欲しくなった。</p>
<p>ところが、「scheme emacs
補完」とかで検索すると、結構面倒臭そうな方法が多い。  </p>
<p>結局、emacsのパッケージ管理システムを使ってauto-completeをインストールする方法が一番楽そうだ、という結論に達した。  </p>
<p>その方法を備忘録も兼ねて記載しておく。ちなみにEmacsのバージョンは24.2だ。</p>
<p>まず、パッケージ管理システムを利用したことのない人はリポジトリを設定しよう。</p>
<p>``` {.lang:lisp .decode:true title="リポジトリの設定。"}
;;;;;;;;;;;;;;;;;;;;Package;;;;;;;;;;;;;;;;;;;;</p>
<p>(require 'package)
(add-to-list 'package-archives
         '("marmalade" . "http://marmalade-repo ...</p>	
						 <a class="readmore" href="/emacs%e3%81%a7scheme%e3%81%ae%e8%87%aa%e5%8b%95%e8%a3%9c%e5%ae%8c%e3%82%92%e8%a1%8c%e3%81%86%e3%80%82.html">Lire la suite …</a>
						</div>
					</div>
        
 
			                <div class="post summary">
						<h2 class="title"><a href="/sicp-%e7%ac%ac1%e7%ab%a0%e3%80%8cbuilding-abstractions-with-procedures%e3%80%8d%e3%82%92%e8%aa%ad%e3%81%bf%e7%b5%82%e3%81%88%e3%81%a6%e3%80%82%e5%be%8c%e7%b7%a8.html">SICP 第1章「Building Abstractions with Procedures」を読み終えて。(後編)</a></h2>
						<p class="meta"><span class="date">Le 日 27 10月 2013</span><span class="posted">Par <a href="#">nishiyama101</a></span></p>
						<div style="clear: both;">&nbsp;</div>
						<div class="entry">
						 <p><a href="http://yuseinishiyama.com/archives/184" title="SICP 第1章「Building Abstractions with Procedures」を読み終えて。(前編)">(前編はこちら)</a></p>
<p>1章から学べたことを列挙する。</p>
<p>・Schemeに慣れた。  </p>
<p>if、cond、define、let、lambdaなどを用いてプログラミングできるようになった。例の「カッコ」にもだいぶ慣れてきた。</p>
<p>・linear recursionとiterationの違いが分かるようになった。  </p>
<p>今以上に不慣れな時のコードではあるが、以下のようにrecursionとiterationで再帰が書けるようになった。後者のほうが遥かに効率が良い。</p>
<p>``` {.lang:scheme .decode:true title="Exercise 1.11. "}
;recursion
(define (f n)
  (cond ((&lt; n 3) n)
        (else (+ (f (- n 1))
                 (<em> 2 (f (- n 2)))
                 (</em> 3 (f (- n 3)))))))</p>
<p>;iteration
(define (f-iter product product-1 product-2 ...</p>	
						 <a class="readmore" href="/sicp-%e7%ac%ac1%e7%ab%a0%e3%80%8cbuilding-abstractions-with-procedures%e3%80%8d%e3%82%92%e8%aa%ad%e3%81%bf%e7%b5%82%e3%81%88%e3%81%a6%e3%80%82%e5%be%8c%e7%b7%a8.html">Lire la suite …</a>
						</div>
					</div>
        
 
			                <div class="post summary">
						<h2 class="title"><a href="/sicp-%e7%ac%ac1%e7%ab%a0%e3%80%8cbuilding-abstractions-with-procedures%e3%80%8d%e3%82%92%e8%aa%ad%e3%81%bf%e7%b5%82%e3%81%88%e3%81%a6%e3%80%82%e5%89%8d%e7%b7%a8.html">SICP 第1章「Building Abstractions with Procedures」を読み終えて。(前編)</a></h2>
						<p class="meta"><span class="date">Le 日 27 10月 2013</span><span class="posted">Par <a href="#">nishiyama101</a></span></p>
						<div style="clear: both;">&nbsp;</div>
						<div class="entry">
						 <p><a href="http://yuseinishiyama.com/archives/179" title="代替不可能なプログラマとは。">先日の投稿「代替不可能なプログラマとは。」</a>にある通り、SICPを読み始め、先日第1章「Building
Abstractions with
Procedures」を読み終えた。実際には<a href="http://yuseinishiyama.com/archives/179" title="代替不可能なプログラマとは。">先日の投稿</a>より少し前から読み始めていて、1章読み終えるのに3週間ほどかかったことになる。(さらに言うと、3ヶ月ほど前に、ビデオ講義を3時間分ほど鑑賞した。この時は、テキストが存在することを知らなかったのと、当たり前だが偉大なるハル・アベルソン氏とジェラルド・ジェイ・サスマン氏の早口の英語が聞き取れるはずもなく、あえなく挫折した。)</p>
<p>学習環境は以下。</p>
<p>・テキストは原著で。  </p>
<p>テキストは原著がオンラインで閲覧できるので、原著で読むことにした。日本語訳に対する酷評を聞き過ぎたせいで、理解できなかった場合に翻訳のせいにしてしまいそうだからだ。それと、語学能力の訓練にもなればと思っている。英語だけをやっている時間がないので、英語とプログラミングを一緒に効率良く学びたい。</p>
<p>・開発環境にはDrRacketを使用。  </p>
<p>コマンドラインとかEmacsとかも試してみたが、結局一番楽そうなものに落ち着いた。</p>
<p>SICPを読んだ結果できるようになること、得られる知識というのははっきりしていなくて、ただただ今よりプログラミングを深く理解できるに違いないという予感だけがモチベーションになっている。SICPに関して「<a href="http://www.cs.berkeley.edu/~bh/sicp.html" title="Why Structure and Interpretation of Computer Programs matters">Why
Structure and Interpretation of Computer Programs
matters</a>」という記事を見つけた ...</p>	
						 <a class="readmore" href="/sicp-%e7%ac%ac1%e7%ab%a0%e3%80%8cbuilding-abstractions-with-procedures%e3%80%8d%e3%82%92%e8%aa%ad%e3%81%bf%e7%b5%82%e3%81%88%e3%81%a6%e3%80%82%e5%89%8d%e7%b7%a8.html">Lire la suite …</a>
						</div>
					</div>
					<div style="clear: both;">&nbsp;</div>
				</div>
				<div id="sidebar">
					<div id="logo">
						<h1><a href="">だからといって、このままでいいはずがない。</h1>
					</div>
					<div id="menu">
						<ul>
							<li class="current_page_item"><a href="">Home</a></li>
							<li><a href="/archives.html">Archives</a></li>
                                                            <li><a href="/pages/about-me.html">About Me</a></li>
						</ul>
					</div>
					<ul>
						<li>
							<h2>Catégories</h2>
							<ul>
								 <li ><a href="/category/impressions.html">Impressions</a></li>
								 <li ><a href="/category/impressions-music.html">Impressions, Music</a></li>
								 <li ><a href="/category/impressions-music-programming.html">Impressions, Music, Programming</a></li>
								 <li ><a href="/category/impressions-programming.html">Impressions, Programming</a></li>
								 <li ><a href="/category/impressions-programming-sicp.html">Impressions, Programming, SICP</a></li>
								 <li ><a href="/category/misc.html">misc</a></li>
								 <li ><a href="/category/programming.html">Programming</a></li>
								 <li class="active"><a href="/category/programming-sicp.html">Programming, SICP</a></li>
								 <li ><a href="/category/programming-sicp-patahene.html">Programming, SICP, パタヘネ</a></li>
							</ul>
						</li>
						<li>
							<h2>Blogroll</h2>
							<ul>
                                                            <li><a href="http://getpelican.com/">Pelican</a></li>
                                                            <li><a href="http://python.org/">Python.org</a></li>
                                                            <li><a href="http://jinja.pocoo.org/">Jinja2</a></li>
                                                            <li><a href="#">You can modify those links in your config file</a></li>
							</ul>
						</li>
                                                <li>
                                                        <h2>Social</h2>
                                                        <ul>
                                                            <li><a href="/" rel="alternate">Flux Atom</a></li>
                                                            <li><a href="#">You can add links in your config file</a></li>
                                                            <li><a href="#">Another social link</a></li>
                                                        </ul>
                                                </li><!-- /.social -->
						<li>
						        <h2>Tags</h2>
						        <ul>
						        </ul>
						</li>
						
						
					</ul>
				</div>
				<!-- end #sidebar -->
				<div style="clear: both;">&nbsp;</div>
			</div>
		</div>
	</div>
	<!-- end #page -->

<div id="footer">
	<p>Copyright (c) 2008 Sitename.com. All rights reserved. Design by <a href="http://www.freecsstemplates.org/">CSS Templates</a>.</p>
	<p>Proudly powered by <a href="http://alexis.notmyidea.org/pelican/">pelican</a>, which takes great advantages of <a href="http://python.org">python</a>.
</p>
</div>
<!-- end #footer -->
</body>
</html>